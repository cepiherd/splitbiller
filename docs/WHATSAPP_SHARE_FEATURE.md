# Fitur Share via WhatsApp

## Overview
Fitur share via WhatsApp memungkinkan pengguna untuk membagikan perhitungan pembagian tagihan secara mudah melalui WhatsApp. Fitur ini mendukung berbagai format pesan yang dapat disesuaikan dengan kebutuhan.

## Komponen yang Dibuat

### 1. WhatsAppService (`src/services/whatsappService.ts`)
Service utama yang menangani:
- **Generate pesan WhatsApp** dengan format yang user-friendly
- **Copy to clipboard** functionality
- **Generate WhatsApp URL** untuk mobile dan web
- **Template pesan** untuk berbagai skenario

#### Method Utama:
- `generateUserCalculationMessage()` - Pesan lengkap dengan perhitungan detail per user
- `generateSettlementMessage()` - Pesan singkat hanya berisi pembayaran yang diperlukan
- `generateSummaryMessage()` - Ringkasan balance per user tanpa detail menu
- `generateWhatsAppURL()` - Generate URL untuk membuka WhatsApp
- `copyToClipboard()` - Copy pesan ke clipboard

### 2. WhatsAppShare Component (`src/components/WhatsAppShare.tsx`)
Komponen UI yang menyediakan:
- **Modal interface** untuk memilih jenis pesan
- **Preview pesan** sebelum dibagikan
- **Copy to clipboard** dan **Buka WhatsApp** buttons
- **3 jenis pesan** yang dapat dipilih:
  - ğŸ“Š **Pesan Lengkap** - Detail perhitungan per user, menu items, dan settlements
  - ğŸ’¸ **Pembayaran Saja** - Hanya pembayaran yang diperlukan
  - ğŸ’° **Ringkasan** - Overview balance per user

### 3. Integrasi ke BillSummary
- Button "Share via WhatsApp" menggantikan button Share lama
- Menggunakan data dari `BillSummary` component
- Terintegrasi dengan `BillService` untuk perhitungan

## Format Pesan WhatsApp

### 1. Pesan Lengkap
```
ğŸ’° *Nama Bill* - Perhitungan Pembagian

ğŸ“Š *TOTAL PENGELUARAN*
Rp 150.000

ğŸ‘¥ *PERHITUNGAN PER USER*

*John Doe*
â€¢ Dibayar: Rp 50.000
â€¢ Berhutang: Rp 75.000
â€¢ Subtotal: Rp 70.000
â€¢ Pajak: Rp 5.000
â€¢ Total: Rp 75.000
â€¢ âŒ Kurang: Rp 25.000

ğŸ’¸ *PEMBAYARAN YANG DIPERLUKAN*
1. John Doe â†’ Jane Smith
   Rp 25.000

ğŸ“‹ *DETAIL MENU PER USER*

*Makan Malam*
ğŸ“ Restoran ABC

*John Doe*
â€¢ Nasi Goreng x1 (50.0%)
  Rp 15.000
â€¢ Es Teh x1 (50.0%)
  Rp 5.000
Subtotal: Rp 20.000
Pajak: Rp 2.000
Total: Rp 22.000

ğŸ“± Generated by SplitBiller
ğŸ•’ 15/12/2024 14:30:00
```

### 2. Pembayaran Saja
```
ğŸ’¸ *Nama Bill* - Pembayaran yang Diperlukan

Berikut pembayaran yang perlu dilakukan:

1. *John Doe* bayar ke *Jane Smith*
   ğŸ’° Rp 25.000

ğŸ“± Generated by SplitBiller
```

### 3. Ringkasan
```
ğŸ’° *Nama Bill* - Ringkasan

ğŸ“Š Total: Rp 150.000
ğŸ‘¥ Peserta: 3 orang

*Balance per user:*
â€¢ John Doe: -Rp 25.000
â€¢ Jane Smith: +Rp 15.000
â€¢ Bob Wilson: +Rp 10.000

ğŸ“± Generated by SplitBiller
```

## Fitur Utama

### 1. **3 Jenis Pesan**
- **Pesan Lengkap**: Detail perhitungan per user, menu items, settlements
- **Pembayaran Saja**: Hanya reminder pembayaran yang diperlukan
- **Ringkasan**: Overview cepat balance per user

### 2. **Copy to Clipboard**
- Support modern browsers dengan `navigator.clipboard`
- Fallback untuk browser lama dengan `document.execCommand`
- Visual feedback (success/error states)

### 3. **WhatsApp Integration**
- Generate URL untuk WhatsApp Web dan Mobile
- Support nomor telepon spesifik (jika ada)
- Auto-format pesan untuk WhatsApp

### 4. **Responsive Design**
- Modal yang responsive untuk mobile dan desktop
- Preview pesan yang scrollable
- Button layout yang adaptif

## Data yang Dibagikan

### Perhitungan Per User
- Total yang dibayar per user
- Total yang berhutang per user
- Breakdown subtotal, pajak, dan total
- Subsidi yang diterima (jika ada)
- Final balance (sisa/kurang/lunas)

### Settlements
- Daftar pembayaran yang diperlukan
- Siapa harus bayar ke siapa
- Jumlah yang harus dibayar

### Detail Menu Items
- Item menu yang dipesan
- Quantity dan persentase pembagian
- Harga per item per user
- Breakdown pajak per user

## Cara Penggunaan

1. **Buka Bill Summary** - Pilih bill yang ingin dibagikan
2. **Klik "Share via WhatsApp"** - Button hijau di bagian atas
3. **Pilih Jenis Pesan** - Pilih antara Pesan Lengkap, Pembayaran Saja, atau Ringkasan
4. **Preview Pesan** - Lihat preview pesan sebelum dibagikan
5. **Copy atau Buka WhatsApp** - Copy ke clipboard atau buka WhatsApp langsung

## Technical Details

### Dependencies
- React hooks (useState)
- Lucide React icons
- TypeScript untuk type safety

### Browser Support
- Modern browsers dengan clipboard API
- Fallback untuk browser lama
- Mobile dan desktop support

### Performance
- Lazy loading untuk modal
- Efficient message generation
- Minimal re-renders

## Future Enhancements

### Potensial Fitur Tambahan
1. **Custom Message Template** - User bisa custom format pesan
2. **Scheduled Sharing** - Jadwal pengiriman pesan
3. **Group Chat Integration** - Langsung kirim ke group WhatsApp
4. **Message History** - Simpan pesan yang pernah dibagikan
5. **Export Options** - Export ke format lain (PDF, Excel)

### Technical Improvements
1. **Message Compression** - Compress pesan panjang
2. **Template Engine** - Lebih fleksibel untuk custom template
3. **Analytics** - Track penggunaan fitur share
4. **Caching** - Cache generated messages

## Testing

### Test Cases
1. **Empty Bill** - Bill tanpa expenses
2. **Single User** - Bill dengan 1 user
3. **Multiple Users** - Bill dengan multiple users
4. **With Menu Items** - Bill dengan detail menu
5. **With Tax** - Bill dengan pajak
6. **With Subsidies** - Bill dengan subsidi
7. **Complex Settlements** - Multiple settlements
8. **Long Messages** - Pesan yang sangat panjang

### Browser Testing
- Chrome, Firefox, Safari, Edge
- Mobile browsers (iOS Safari, Chrome Mobile)
- WhatsApp Web integration
- Clipboard functionality

## Troubleshooting

### Common Issues
1. **Clipboard not working** - Check browser permissions
2. **WhatsApp not opening** - Check URL format
3. **Message too long** - WhatsApp has character limits
4. **Special characters** - Proper encoding for WhatsApp

### Solutions
1. **Fallback methods** - Multiple clipboard methods
2. **URL validation** - Validate WhatsApp URLs
3. **Message truncation** - Handle long messages
4. **Character encoding** - Proper UTF-8 encoding
